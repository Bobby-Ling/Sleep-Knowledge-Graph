# TODO

按照优先级排序

## 网页

- [ ] 完成submit_query可视化后要在右侧展示分析界面

- [ ] 完成后要在合适的地方展示二维码, 即session_id, 可供小程序接力 

- [ ] 点击节点要能够显示额外字段信息(neo4j查询语句也要改, API返回的json里面现在没有比如[Non]DrugTreatment相关的属性信息)

 
## 后端

- [x] init_chat要拆分出来, 不能把分析和启动对话糅在一起, 因为用户可能在多个地方需要获取分析结果

- [x] 每次问卷提交后的返回结果现在是独立的(只有推断的可能疾病及其可能性), 没法和小程序的分析界面统一

- [x] 目前返回的分析结果都是文本形式, 包括综合neo4j、量表、病历进行的分析, 显示效果可能不太好, 需要改成json(改提示词, 我已经让他生成几个小标题的内容, 见`SLEEP_ANALYZER_SYSTEM_MSG`)

- [x] 目前API都是非流式的, 延迟很高(10s级别), 最好改成流式的 (不改了)

## 知识图谱

- [x] 效果, 查询效果要找一些样例测试下, 改一下查询策略之类
 
- [x] 症状由于是人工选的, 因此要修改提示词, 让GPT在生成cypher语句时往我们筛选出来的症状靠

- [x] 目前分块是按照token=12000分的, 太大了, 导致知识图谱节点不足, 要改小一点(即每个文件的分块数目变多)

- [x] 目前修改了Schema, 加了病历节点, 但是还没有重新跑


## 诊断功能

- [x] 诊断是否准确没有统一测试过

- [x] 连续对话效果没有进一步测试

## MISC

- [ ] 疾病输出依据匹配度限制

- [ ] 综合分析使用neo4j json, 而非重新生成

- [ ] 数据库重建几次(要求每个字段都要有值; 规范化名词), 并跑分

- [ ] 历史记录大小限制
