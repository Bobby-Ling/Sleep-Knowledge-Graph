(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-diagnosis-diagnosis","components-progress-bar-progress-bar"],{"177c":function(n,t,e){"use strict";e.r(t);var a=e("2e9e"),s=e.n(a);for(var i in a)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return a[n]}))}(i);t["default"]=s.a},"2e9e":function(n,t,e){"use strict";e("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,e("64aa");var a={data:function(){return{steps:[{id:0,name:"症状选择",path:"/pages/chooseSymptoms/chooseSymptoms"},{id:1,name:"初步诊断",path:"/pages/diagnosisResult/diagnosisResult"},{id:2,name:"问卷调查",path:"/pages/test-questions/test-questions"},{id:3,name:"问卷分析",path:"/pages/diagnosis/diagnosis"},{id:4,name:"病历上传",path:"/pages/upload/upload"},{id:5,name:"最终诊断",path:"/pages/analysis_all/analysis_all"}]}},props:{currentStep:{type:Number,default:0}},methods:{navigateToStep:function(n){var t=n.currentTarget.dataset,e=t.path,a=t.index;a<=this.currentStep+1&&uni.navigateTo({url:e})}},created:function(){}};t.default=a},"52fe":function(n,t,e){"use strict";e.d(t,"b",(function(){return a})),e.d(t,"c",(function(){return s})),e.d(t,"a",(function(){}));var a=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("v-uni-view",{staticClass:"nav-container"},[e("v-uni-view",{staticClass:"progress-bar"},[e("v-uni-view",{staticClass:"progress-track"},[e("v-uni-view",{staticClass:"progress-fill",style:"width: "+20*n.currentStep+"%"})],1),e("v-uni-view",{staticClass:"steps-wrapper"},n._l(n.steps,(function(t,a){return e("v-uni-view",{key:a,class:"step-item "+(n.currentStep>=a?"completed":"")+" "+(n.currentStep==a?"current":""),attrs:{"data-path":t.path,"data-index":a},on:{click:function(t){arguments[0]=t=n.$handleEvent(t),n.navigateToStep.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"step-circle"},[e("v-uni-view",{staticClass:"circle-content"},[n.currentStep>a?e("v-uni-text",{staticClass:"check-icon"},[n._v("✓")]):e("v-uni-text",[n._v(n._s(a+1))])],1)],1),e("v-uni-view",{staticClass:"step-label"},[n._v(n._s(t.name))])],1)})),1)],1)],1)},s=[]},"58c0":function(n,t,e){"use strict";e.d(t,"b",(function(){return s})),e.d(t,"c",(function(){return i})),e.d(t,"a",(function(){return a}));var a={progressBar:e("7b50").default},s=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("v-uni-view",[e("progress-bar",{attrs:{"current-step":n.currentStep}}),e("v-uni-view",{staticClass:"container"},[n.loading?e("v-uni-view",{staticClass:"loading"},[e("v-uni-view",{staticClass:"loading-spinner"}),e("v-uni-text",[n._v("分析中...")])],1):n.error?e("v-uni-view",{staticClass:"error"},[e("v-uni-icon",{attrs:{type:"warn",size:"64"}}),e("v-uni-text",[n._v("分析失败，请重试")])],1):[e("v-uni-view",{staticClass:"analysis-card current-analysis"},[e("v-uni-view",{staticClass:"card-title"},[n._v("当前问卷分析")]),n.currentAnalysis.summary?e("v-uni-view",{staticClass:"score-section"},[e("v-uni-view",{staticClass:"progress-container"},[e("v-uni-canvas",{staticClass:"progress-canvas",attrs:{"canvas-id":"progressBar"}}),e("v-uni-view",{staticClass:"score-text"},[e("v-uni-text",{staticClass:"score"},[n._v(n._s(n.currentAnalysis.summary.score))]),e("v-uni-text",{staticClass:"max-score"},[n._v("/"+n._s(n.currentAnalysis.summary.max_score))])],1)],1),e("v-uni-view",{staticClass:"interpretation"},[e("v-uni-text",{staticClass:"level-label"},[n._v(n._s(n.currentAnalysis.summary.interpretation))]),e("v-uni-view",{staticClass:"levels-list"},n._l(n.currentAnalysis.summary.levels,(function(t,a){return e("v-uni-view",{key:a,staticClass:"level-item"},[e("v-uni-view",{staticClass:"level-dot"}),e("v-uni-text",[n._v(n._s(t.label)+" ("+n._s(t.from)+"-"+n._s(t.to)+"分)")])],1)})),1)],1)],1):n._e(),n.currentAnalysis.details?e("v-uni-view",{staticClass:"components-section"},[e("v-uni-view",{staticClass:"component-list"},n._l(n.currentAnalysis.details.components,(function(t,a){return e("v-uni-view",{key:a,staticClass:"component-item"},[e("v-uni-view",{staticClass:"component-header"},[e("v-uni-text",{staticClass:"component-name"},[n._v(n._s(t.name))]),e("v-uni-text",{staticClass:"component-score"},[n._v(n._s(t.score)+"/"+n._s(t.max_score))])],1),e("v-uni-view",{staticClass:"progress-bar"},[e("v-uni-view",{staticClass:"progress",style:"width: "+t.score/t.max_score*100+"%"})],1)],1)})),1)],1):n._e()],1),n.combinedAnalysis?e("v-uni-view",{staticClass:"analysis-card combined-analysis"},[e("v-uni-view",{staticClass:"card-title"},[n._v("综合诊断分析")]),e("v-uni-view",{staticClass:"summary-section"},[e("v-uni-text",{staticClass:"summary-text"},[n._v(n._s(n.combinedAnalysis.summary))])],1),e("v-uni-view",{staticClass:"predictions-section"},[e("v-uni-view",{staticClass:"prediction-list"},n._l(n.combinedAnalysis.predict,(function(t,a){return e("v-uni-view",{key:a,staticClass:"prediction-item"},[e("v-uni-view",{staticClass:"prediction-bar"},[e("v-uni-view",{staticClass:"prediction-progress",style:"width: "+100*t.probability+"%"}),e("v-uni-text",{staticClass:"prediction-label"},[n._v(n._s(t.diagnosis))]),e("v-uni-text",{staticClass:"prediction-probability"},[n._v(n._s(100*t.probability)+"%")])],1)],1)})),1)],1)],1):n._e()]],2)],1)},i=[]},"669a":function(n,t,e){"use strict";e("6a54");var a=e("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,e("c223");var s=a(e("7b50")),i=a(e("7b50")),r={components:{progressBar:s.default},data:function(){return{currentAnalysis:null,combinedAnalysis:null,loading:!0,error:!1,currentStep:3,score:"",max_score:"",interpretation:"",levels:[],components:[]}},onLoad:function(){var n=getApp(),t=n.globalData.selectedAnswers,e=n.globalData.schema_name,a="5b1ff5cb-39b2-4210-99f2-9c7e85d08322";console.log(t),this.getCurrentAnalysis(a,e,t),this.getCombinedAnalysis(a,n.globalData.scaleResults)},methods:{updateStep:function(n){this.setData({currentStep:n})},getCurrentAnalysis:function(n,t,e){var a=this;uni.request({url:"http://bobby.ipyingshe.net:22630/scales/".concat(n,"/").concat(t),method:"POST",data:e,success:function(n){if(a.setData({currentAnalysis:n.data,loading:!1}),n.data.summary){var t=n.data.summary.score,e=n.data.summary.max_score,s=t/e*100;a.drawProgressBar(s)}},fail:function(n){console.error("Failed to get current analysis:",n),a.setData({error:!0,loading:!1})}})},getCombinedAnalysis:function(n,t){var e=this;uni.request({url:"http://bobby.ipyingshe.net:22630/scales/".concat(n),method:"POST",data:t,success:function(n){e.setData({combinedAnalysis:n.data})},fail:function(n){console.error("Failed to get combined analysis:",n)}})},drawProgressBar:function(n){var t=uni.createCanvasContext("progressBar");t.beginPath(),t.arc(75,75,60,0,2*Math.PI),t.setLineWidth(10),t.setStrokeStyle("#E5E5E5"),t.stroke(),t.beginPath(),t.arc(75,75,60,-Math.PI/2,-Math.PI/2+2*Math.PI*n/100),t.setLineWidth(10),t.setStrokeStyle(this.getColorByPercentage(n)),t.stroke(),t.draw()},getColorByPercentage:function(n){return n<=30?"#4CAF50":n<=70?"#FFC107":"#F44336"}}};t.default=r,t.default.components=Object.assign({"progress-bar":i.default},t.default.components||{})},"69df":function(n,t,e){"use strict";var a=e("d319"),s=e.n(a);s.a},"6f77":function(n,t,e){"use strict";var a=e("bf47"),s=e.n(a);s.a},7848:function(n,t,e){var a=e("c86c");t=a(!1),t.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* components/progress-bar/progress-bar.wxss */.nav-container[data-v-10ebe0d6]{width:100%;background:#fff;padding:%?20?% %?30?%;box-sizing:border-box;margin-bottom:%?20?% /* 添加底部间距 */}.progress-bar[data-v-10ebe0d6]{position:relative;padding:%?30?% 0}.progress-track[data-v-10ebe0d6]{position:absolute;top:%?60?%;left:8%;width:84%;height:%?4?%;background:#e8e8e8;border-radius:%?2?%}.progress-fill[data-v-10ebe0d6]{position:absolute;top:0;left:0;height:100%;background:linear-gradient(90deg,#4a90e2,#64b5f6);border-radius:%?2?%;transition:width .3s ease}.steps-wrapper[data-v-10ebe0d6]{position:relative;display:flex;justify-content:space-between;padding:0 %?20?%}.step-item[data-v-10ebe0d6]{display:flex;flex-direction:column;align-items:center;position:relative;flex:1;z-index:1}.step-circle[data-v-10ebe0d6]{width:%?48?%;height:%?48?%;border-radius:50%;background:#fff;border:%?3?% solid #e8e8e8;display:flex;align-items:center;justify-content:center;margin-bottom:%?16?%;transition:all .3s ease;font-size:%?24?%;color:#999}.circle-content[data-v-10ebe0d6]{display:flex;align-items:center;justify-content:center;width:100%;height:100%}.step-label[data-v-10ebe0d6]{font-size:%?24?%;color:#999;transition:all .3s ease;text-align:center;white-space:nowrap;-webkit-transform:scale(.9);transform:scale(.9) /* 稍微缩小文字以适应窄屏 */}\n/* 已完成步骤的样式 */.step-item.completed .step-circle[data-v-10ebe0d6]{background:#4a90e2;border-color:#4a90e2;color:#fff}.step-item.completed .step-label[data-v-10ebe0d6]{color:#4a90e2}\n/* 当前步骤的样式 */.step-item.current .step-circle[data-v-10ebe0d6]{background:#fff;border-color:#4a90e2;color:#4a90e2;box-shadow:0 0 0 %?4?% rgba(74,144,226,.2)}.step-item.current .step-label[data-v-10ebe0d6]{color:#4a90e2;font-weight:500}.check-icon[data-v-10ebe0d6]{font-size:%?24?%;font-weight:700}\n/* 动画效果 */.step-item[data-v-10ebe0d6]{transition:-webkit-transform .2s ease;transition:transform .2s ease;transition:transform .2s ease,-webkit-transform .2s ease}.step-item[data-v-10ebe0d6]:active{-webkit-transform:scale(.95);transform:scale(.95)}\n/* 适配深色模式 */@media (prefers-color-scheme:dark){.nav-container[data-v-10ebe0d6]{background:#2c2c2c}.progress-track[data-v-10ebe0d6]{background:#404040}.step-circle[data-v-10ebe0d6]{background:#2c2c2c;border-color:#404040}.step-item.current .step-circle[data-v-10ebe0d6]{background:#2c2c2c}}\n/* 响应式调整 */@media screen and (max-width:375px){.step-label[data-v-10ebe0d6]{-webkit-transform:scale(.85);transform:scale(.85)}.step-circle[data-v-10ebe0d6]{width:%?44?%;height:%?44?%}}",""]),n.exports=t},"7b50":function(n,t,e){"use strict";e.r(t);var a=e("52fe"),s=e("177c");for(var i in s)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return s[n]}))}(i);e("69df");var r=e("828b"),o=Object(r["a"])(s["default"],a["b"],a["c"],!1,null,"10ebe0d6",null,!1,a["a"],void 0);t["default"]=o.exports},"863f":function(n,t,e){var a=e("c86c");t=a(!1),t.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* diagnosis.wxss */.container[data-v-7a573501]{padding:%?20?%;background:#f5f6fa;min-height:100vh}.loading[data-v-7a573501]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:%?400?%}.loading-spinner[data-v-7a573501]{width:%?64?%;height:%?64?%;border:%?6?% solid #f3f3f3;border-top:%?6?% solid #007aff;border-radius:50%;-webkit-animation:spin-data-v-7a573501 1s linear infinite;animation:spin-data-v-7a573501 1s linear infinite}@-webkit-keyframes spin-data-v-7a573501{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spin-data-v-7a573501{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.error[data-v-7a573501]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:%?400?%;color:#ff4d4f}.analysis-card[data-v-7a573501]{background:#fff;border-radius:%?20?%;padding:%?30?%;margin-bottom:%?30?%;box-shadow:0 %?2?% %?10?% rgba(0,0,0,.05)}.card-title[data-v-7a573501]{font-size:%?36?%;font-weight:700;color:#333;margin-bottom:%?30?%;padding-left:%?20?%;border-left:%?8?% solid #007aff}.score-section[data-v-7a573501]{display:flex;align-items:center;justify-content:space-between;margin-bottom:%?40?%}.progress-container[data-v-7a573501]{position:relative;width:%?150?%}.score-text[data-v-7a573501]{position:absolute;top:50%;left:100%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center}.score[data-v-7a573501]{font-size:%?40?%;font-weight:700;color:#333}.max-score[data-v-7a573501]{font-size:%?24?%;color:#999}.interpretation[data-v-7a573501]{margin-left:%?100?%}.level-label[data-v-7a573501]{font-size:%?32?%;font-weight:700;color:#333;margin-bottom:%?20?%;display:block}.levels-list[data-v-7a573501]{margin-top:%?20?%}.level-item[data-v-7a573501]{display:flex;align-items:center;margin-bottom:%?10?%;font-size:%?26?%;color:#666}.level-dot[data-v-7a573501]{width:%?12?%;height:%?12?%;border-radius:50%;background:#007aff;margin-right:%?10?%}.components-section[data-v-7a573501]{margin-top:%?40?%}.component-item[data-v-7a573501]{margin-bottom:%?30?%}.component-header[data-v-7a573501]{display:flex;justify-content:space-between;margin-bottom:%?10?%}.component-name[data-v-7a573501]{font-size:%?28?%;color:#333}.component-score[data-v-7a573501]{font-size:%?28?%;color:#666}.progress-bar[data-v-7a573501]{height:%?12?%;background:#f5f5f5;border-radius:%?6?%;overflow:hidden}.progress[data-v-7a573501]{height:100%;background:#007aff;border-radius:%?6?%;transition:width .3s ease}.summary-section[data-v-7a573501]{margin-bottom:%?40?%}.summary-text[data-v-7a573501]{font-size:%?32?%;color:#333;line-height:1.6}.prediction-item[data-v-7a573501]{margin-bottom:%?30?%}.prediction-bar[data-v-7a573501]{position:relative;height:%?80?%;background:#f5f5f5;border-radius:%?10?%;overflow:hidden}.prediction-progress[data-v-7a573501]{position:absolute;height:100%;background:rgba(0,122,255,.1);transition:width .3s ease}.prediction-label[data-v-7a573501]{position:absolute;left:%?20?%;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);font-size:%?28?%;color:#333}.prediction-probability[data-v-7a573501]{position:absolute;right:%?20?%;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);font-size:%?28?%;color:#007aff;font-weight:700}",""]),n.exports=t},ab82:function(n,t,e){"use strict";e.r(t);var a=e("669a"),s=e.n(a);for(var i in a)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return a[n]}))}(i);t["default"]=s.a},bf47:function(n,t,e){var a=e("863f");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);var s=e("967d").default;s("8399ea3a",a,!0,{sourceMap:!1,shadowMode:!1})},d319:function(n,t,e){var a=e("7848");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);var s=e("967d").default;s("230c1372",a,!0,{sourceMap:!1,shadowMode:!1})},da4f:function(n,t,e){"use strict";e.r(t);var a=e("58c0"),s=e("ab82");for(var i in s)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return s[n]}))}(i);e("6f77");var r=e("828b"),o=Object(r["a"])(s["default"],a["b"],a["c"],!1,null,"7a573501",null,!1,a["a"],void 0);t["default"]=o.exports}}]);